<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HTML格式报告</title>

  <!-- 引入Ant Design Vue的CSS样式 -->
  <!-- 引入Vue.js和Ant Design Vue的脚本 -->
  <!-- vue.min.js -->
  <!-- antd.min.js -->
</head>
<!-- antd.min.css -->
<body>
<div id="app">

<a-row :gutter="[0,{ xs: 8, sm: 16, md: 24, lg: 32 }]">
  <a-col>
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="361" height="56" role="img" aria-label="WJLIN0: PATHSCAN">
      <title>WJLIN0: PATHSCAN</title>
      <g shape-rendering="crispEdges">
        <rect width="173" height="56" fill="#ffffff"/>
        <rect x="173" width="188" height="56" fill="#f8f9f9"/>
      </g>
      <g fill="#fff" text-anchor="middle" font-family="Verdana,Geneva,DejaVu Sans,sans-serif" text-rendering="geometricPrecision" font-size="200">
        <image x="18" y="14" width="28" height="28" xlink:href="data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjMDA3ZWM2IiByb2xlPSJpbWciIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48dGl0bGU+R288L3RpdGxlPjxwYXRoIGQ9Ik0xLjgxMSAxMC4yMzFjLS4wNDcgMC0uMDU4LS4wMjMtLjAzNS0uMDU5bC4yNDYtLjMxNWMuMDIzLS4wMzUuMDgxLS4wNTguMTI4LS4wNThoNC4xNzJjLjA0NiAwIC4wNTguMDM1LjAzNS4wN2wtLjE5OS4zMDNjLS4wMjMuMDM2LS4wODIuMDctLjExNy4wN3pNLjA0NyAxMS4zMDZjLS4wNDcgMC0uMDU5LS4wMjMtLjAzNS0uMDU4bC4yNDUtLjMxNmMuMDIzLS4wMzUuMDgyLS4wNTguMTI5LS4wNThoNS4zMjhjLjA0NyAwIC4wNy4wMzUuMDU4LjA3bC0uMDkzLjI4Yy0uMDEyLjA0Ny0uMDU4LjA3LS4xMDUuMDd6bTIuODI4IDEuMDc1Yy0uMDQ3IDAtLjA1OS0uMDM1LS4wMzUtLjA3bC4xNjMtLjI5MmMuMDIzLS4wMzUuMDctLjA3LjExNy0uMDdoMi4zMzdjLjA0NyAwIC4wNy4wMzUuMDcuMDgybC0uMDIzLjI4YzAgLjA0Ny0uMDQ3LjA4Mi0uMDgyLjA4MnptMTIuMTI5LTIuMzZjLS43MzYuMTg3LTEuMjM5LjMyNy0xLjk2My41MTQtLjE3Ni4wNDYtLjE4Ny4wNTgtLjM0LS4xMTctLjE3NC0uMTk5LS4zMDMtLjMyNy0uNTQ4LS40NDQtLjczNy0uMzYyLTEuNDUtLjI1Ny0yLjExNS4xNzUtLjc5NS41MTQtMS4yMDQgMS4yNzQtMS4xOTIgMi4yMi4wMTEuOTM1LjY1NCAxLjcwNiAxLjU3NyAxLjgzNS43OTUuMTA1IDEuNDYtLjE3NSAxLjk4Ny0uNzcuMTA1LS4xMy4xOTgtLjI3LjMxNS0uNDM0SDEwLjQ3Yy0uMjQ1IDAtLjMwNC0uMTUyLS4yMjItLjM1LjE1Mi0uMzYyLjQzMi0uOTcuNTk2LTEuMjc0YS4zMTUuMzE1IDAgMDEuMjkyLS4xODdoNC4yNTNjLS4wMjMuMzE2LS4wMjMuNjMxLS4wNy45NDdhNC45ODMgNC45ODMgMCAwMS0uOTU4IDIuMjljLS44NDEgMS4xMS0xLjk0IDEuOC0zLjMzIDEuOTg2LTEuMTQ1LjE1Mi0yLjIwOS0uMDctMy4xNDMtLjc3LS44NjUtLjY1NS0xLjM1Ni0xLjUyLTEuNDg0LTIuNTk1LS4xNTItMS4yNzQuMjIyLTIuNDE5Ljk5My0zLjQyNC44My0xLjA4NiAxLjkyOC0xLjc3NiAzLjI3Mi0yLjAyIDEuMDk4LS4yIDIuMTUtLjA3IDMuMDk2LjU3MS42Mi40MSAxLjA2My45NyAxLjM1NiAxLjY0OC4wNy4xMDUuMDIzLjE2NC0uMTE3LjJtMy44NjggNi40NjFjLTEuMDY0LS4wMjQtMi4wMzQtLjMyOC0yLjg1Mi0xLjAyOWEzLjY2NSAzLjY2NSAwIDAxLTEuMjYyLTIuMjU1Yy0uMjEtMS4zMi4xNTItMi40ODkuOTQ3LTMuNTI5Ljg1My0xLjEyMiAxLjg4MS0xLjcwNiAzLjI3Mi0xLjk1IDEuMTkyLS4yMSAyLjMxNC0uMDk1IDMuMzMuNTk1LjkyMy42MyAxLjQ5NiAxLjQ4NCAxLjY0OCAyLjYwNS4xOTggMS41NzgtLjI1NyAyLjg2My0xLjM0NCAzLjk2Mi0uNzcxLjc4My0xLjcxOCAxLjI3My0yLjgwNSAxLjQ5NS0uMzE1LjA2LS42My4wNy0uOTM0LjEwNnptMi43OC00LjcyYy0uMDExLS4xNTMtLjAxMS0uMjctLjAzNC0uMzg3LS4yMS0xLjE1Ny0xLjI3NC0xLjgxLTIuMzg0LTEuNTU0LTEuMDg3LjI0NS0xLjc4OC45MzUtMi4wNDUgMi4wMzMtLjIxLjkxMi4yMzQgMS44MzUgMS4wNzUgMi4yMS42NDMuMjggMS4yODUuMjQ0IDEuOTA1LS4wNy45MjMtLjQ4IDEuNDI1LTEuMjI4IDEuNDg0LTIuMjMzeiIvPjwvc3ZnPg=="/>
        <text transform="scale(.1)" x="1035" y="340" textLength="910" fill="#333">WJLIN0</text>
        <text transform="scale(.1)" x="2670" y="340" textLength="1400" fill="#333" font-weight="bold">PATHSCAN</text>
      </g>
    </svg>
  </a-col>
  <a-table :columns="columns" :data-source="data"  tableLayout="fixed" class="components-table-demo-nested" bordered>
    <div
            slot="filterDropdown"
            slot-scope="{ setSelectedKeys, selectedKeys, confirm, clearFilters, column }"
            style="padding: 8px"
    >
      <a-input
              v-ant-ref="c => (searchInput = c)"
              :placeholder="`Search ${column.dataIndex}`"
              :value="selectedKeys[0]"
              style="width: 188px; margin-bottom: 8px; display: block;"
              @change="e => setSelectedKeys(e.target.value ? [e.target.value] : [])"
              @pressEnter="() => handleSearch(selectedKeys, confirm, column.dataIndex)">

      </a-input>
      <a-button
              type="primary"
              icon="search"
              size="small"
              style="width: 90px; margin-right: 8px"
              @click="() => handleSearch(selectedKeys, confirm, column.dataIndex)"
      >
        Search
      </a-button>
      <a-button size="small" style="width: 90px" @click="() => handleReset(clearFilters)">
        Reset
      </a-button>
    </div>
    <a-icon
            slot="filterIcon"
            slot-scope="filtered"
            type="search"
            :style="{ color: filtered ? '#108ee9' : undefined }"></a-icon>
    <template slot="customRender" slot-scope="text, record, index, column">
      <span v-if="searchText && searchedColumn === column.dataIndex">
        <template
                v-for="(fragment, i) in text
            .toString()
            .split(new RegExp(`(?<=${searchText})|(?=${searchText})`, 'i'))"
        >
          <mark
                  v-if="fragment.toLowerCase() === searchText.toLowerCase()"
                  :key="i"
                  class="highlight"
          >{{ fragment }}</mark
          >
          <template v-else>{{ fragment }}</template>
        </template>
      </span>
      <template v-else>
        {{ text }}
      </template>
    </template>
    <span slot="technology" slot-scope="technology">
      <a-tag
              v-for="tag in technology"
              :key="tag"
              :color="getRandomColor(tag)"
      >
       {{ tag.charAt(0).toUpperCase() + tag.slice(1) }}
      </a-tag>
    </span>


    <a-descriptions
            title="详情"
            slot="expandedRowRender"
            slot-scope="text"
            bordered
            :column="2"
    >
      <a-descriptions-item label="目标" :span="1">
        <a :href="fullURL(text.target,text.path)">{{ fullURL(text.target,text.path) }}</a>
      </a-descriptions-item>
      <a-descriptions-item label="A" :span="1">
        {{ text.A }}
      </a-descriptions-item>
      <a-descriptions-item label="CNAME" :span="1">
        {{ text.CNAME }}
      </a-descriptions-item>
      <a-descriptions-item label="状态码" :span="1">
        {{ text.status }}
      </a-descriptions-item>
      <a-descriptions-item label="标题" :span="3">
        {{ text.title }}
        <a-tag
                v-for="tag in text.technology"
                :key="tag"
                :color="getRandomColor(tag)"
        >
          {{ tag.charAt(0).toUpperCase() + tag.slice(1) }}
        </a-tag>
      </a-descriptions-item>
      <a-descriptions-item label="请求包" :span="3">
        <pre style="white-space: pre-line;">{{ text.request }}</pre>
      </a-descriptions-item>
      <a-descriptions-item label="响应包" :span="3">
        <pre style="white-space: pre-line;">{{ text.response }}</pre>
      </a-descriptions-item>
    </a-descriptions>
  </a-table>
</a-row>




</div>

<script>
  const columns = [
    { title: '时间', dataIndex: 'timestamp', key: 'timestamp', scopedSlots: {filterDropdown: 'filterDropdown', filterIcon: 'filterIcon', customRender: 'customRender',},
      onFilter: (value, record) =>
              record.timestamp
                      .toString()
                      .toLowerCase()
                      .includes(value.toLowerCase()),
      onFilterDropdownVisibleChange: visible => {
        if (visible) {
          setTimeout(() => {
            this.searchInput.focus();
          });
        }
      },
    },
    { title: '目标', dataIndex: 'target', key: 'target' ,scopedSlots: {filterDropdown: 'filterDropdown', filterIcon: 'filterIcon', customRender: 'customRender',},
      onFilter: (value, record) =>
              record.target
                      .toString()
                      .toLowerCase()
                      .includes(value.toLowerCase()),
      onFilterDropdownVisibleChange: visible => {
        if (visible) {
          setTimeout(() => {
            this.searchInput.focus();
          });
        }
      }, },
    { title: 'Host', dataIndex: 'host', key: 'host' ,scopedSlots: {filterDropdown: 'filterDropdown', filterIcon: 'filterIcon', customRender: 'customRender',},
      onFilter: (value, record) =>
              record.target
                      .toString()
                      .toLowerCase()
                      .includes(value.toLowerCase()),
      onFilterDropdownVisibleChange: visible => {
        if (visible) {
          setTimeout(() => {
            this.searchInput.focus();
          });
        }
      }, },
    { title: '路径', dataIndex: 'path', key: 'path' ,scopedSlots: {filterDropdown: 'filterDropdown', filterIcon: 'filterIcon', customRender: 'customRender',},
      onFilter: (value, record) =>
              record.path
                      .toString()
                      .toLowerCase()
                      .includes(value.toLowerCase()),
      onFilterDropdownVisibleChange: visible => {
        if (visible) {
          setTimeout(() => {
            this.searchInput.focus();
          });
        }
      }},
    { title: '标题', dataIndex: 'title', key: 'title',scopedSlots: {filterDropdown: 'filterDropdown', filterIcon: 'filterIcon', customRender: 'customRender',} ,
      onFilter: (value, record) =>
              record.title
                      .toString()
                      .toLowerCase()
                      .includes(value.toLowerCase()),
      onFilterDropdownVisibleChange: visible => {
        if (visible) {
          setTimeout(() => {
            this.searchInput.focus();
          });
        }
      }},
    { title: '状态码', dataIndex: 'status', key: 'status',scopedSlots: {filterDropdown: 'filterDropdown', filterIcon: 'filterIcon', customRender: 'customRender',} ,
      onFilter: (value, record) =>
              record.status
                      .toString()
                      .toLowerCase()
                      .includes(value.toLowerCase()),
      onFilterDropdownVisibleChange: visible => {
        if (visible) {
          setTimeout(() => {
            this.searchInput.focus();
          });
        }
      }},
    { title: '指纹', dataIndex: 'technology', key: 'technology',scopedSlots: { customRender: 'technology' } },
  ];

  const data = [];
  //?a
  const innerColumns = [
    { title: '时间', dataIndex: 'timestamp', key: 'timestamp' },
    { title: '目标', dataIndex: 'target', key: 'target' },
    { title: 'Host', dataIndex: 'host', key: 'host' },
    { title: 'A', dataIndex: 'A', key: 'A' },
    { title: 'CNAME', dataIndex: 'CNAME', key: 'CNAME' },
    { title: '标题', dataIndex: 'title', key: 'title' },
    { title: '状态码', dataIndex: 'status', key: 'status' },
    { title: '指纹', dataIndex: 'technology', key: 'technology',},
    { title: '请求包',dataIndex: 'request',key: 'request',},
    { title: '响应包',dataIndex: 'response',key: 'response',}
  ];

  const innerData = data;

  new Vue({
    el: '#app',
    data: {
      data,
      columns,
      innerColumns,
      innerData,
      searchText: '',
      searchInput: null,
      searchedColumn: '',
    },
    methods: {
      handleSearch(selectedKeys, confirm, dataIndex) {
        confirm();
        this.searchText = selectedKeys[0];
        this.searchedColumn = dataIndex;
      },

      handleReset(clearFilters) {
        clearFilters();
        this.searchText = '';
      },
      getRandomColor(tag) {
        const colors = ['geekblue', 'green', 'red', 'blue', 'purple', 'orange', 'yellow'];
        const randomIndex = Math.floor(Math.random() * colors.length);
        return colors[randomIndex];
      },
      fullURL(k,v) {
        if (!k || !v) {
         return k
        }

        if (!k.endsWith("/")) {
          k += "/";
        }

        if (v.startsWith("/")) {
          v = v.substring(1);
        }

        return k + v;
      },
    }
  });
</script>

</body>

</html>